#!/usr/bin/make -f

%:
	dh $@

override_dh_auto_build:
	# 构建前端
	pnpm install
	pnpm build
	
	# 构建后端
	cd backend && go mod tidy && go build -o config-manager-backend cmd/server/main.go

override_dh_auto_clean:
	# 清理构建文件
	rm -rf dist/
	rm -rf node_modules/
	rm -f backend/config-manager-backend
	dh_auto_clean

override_dh_auto_test:
	# 跳过测试（可选）

override_dh_installdeb:
	dh_installdeb
	# 设置脚本权限
	chmod 755 debian/*/DEBIAN/postinst
	chmod 755 debian/*/DEBIAN/prerm
	chmod 755 debian/*/DEBIAN/postrm